'''Blacklist server'''

from discord.ext import commands
from packages.utils import Embed, ImproperType
import json, requests, os
from mongoclient import DBClient
class Command(commands.Cog):
    def __init__(self, client):
        self.client = client
    @commands.command()
    async def blacklist(self, ctx, serverid):
        #return await ctx.send('This command is currently under maintenance. The developers will try to get it up again as soon as possible. In the meantime feel free to use `n.help` to get the other commands. Thank you for your understanding!')
        if ctx.author.id not in [505338178287173642, 637638904513691658, 396075607420567552]:
            embed = Embed('Error!', 'You are not a dev!', 'warning')
            if (ctx.author.id) not in [505338178287173642, 637638904513691658, 396075607420567552, 724772394748870718]:
              embed.footer('âš™ï¸This command is a ğŸ› ï¸developerğŸ› ï¸ only command.âš™ï¸ \nBecome a premium ğŸ’  member today!','https://media.discordapp.net/attachments/719414661686099993/765110312482766919/NT_Server_Halloween_Logo_2020_GIF.gif')
            else: 
              embed.footer('âš™ï¸This command is a ğŸ› ï¸developerğŸ› ï¸ only command.âš™ï¸\n Discord user '+str(ctx.author.name + '#' + ctx.author.discriminator)+' is a ğŸ› ï¸developerğŸ› ï¸ of this bot.', 'https://media.discordapp.net/attachments/719414661686099993/765490220858081280/output-onlinepngtools_32.png')
            return await embed.send(ctx)
        else:
            #data = json.loads(requests.get('https://blacklisted-db.nitrotypers.repl.co', data={"key": os.getenv('DB_KEY')}).text)['data']
            dbclient = DBClient()
            collection = dbclient.db.blacklisted
            data = await dbclient.get_big_array(collection, 'blacklisted')
            data['blacklisted'].append(serverid)
            #requests.post('https://blacklisted-db.nitrotypers.repl.co', data={'key': os.getenv('DB_KEY'), 'data': json.dumps(data)})
            await dbclient.update_big_array(collection, 'blacklisted', data)
            embed = Embed('Success!', f'Blacklisted server {str(ctx.author.guild.id)}!', 'white_check_mark')
            if (ctx.author.id) not in [505338178287173642, 637638904513691658, 396075607420567552]:
              embed.footer('âš™ï¸This command is a ğŸ› ï¸developerğŸ› ï¸ only command.âš™ï¸ \nBecome a premium ğŸ’  member today!','https://media.discordapp.net/attachments/719414661686099993/765110312482766919/NT_Server_Halloween_Logo_2020_GIF.gif')
            else:
              embed.footer('âš™ï¸ï¸Tï¸hï¸iï¸sï¸ ï¸cï¸oï¸mï¸mï¸aï¸nï¸dï¸ ï¸iï¸sï¸ ï¸aï¸ï¸ ï¸ğŸ› ï¸dï¸eï¸vï¸eï¸lï¸oï¸pï¸eï¸rï¸ğŸ› ï¸ ï¸oï¸nï¸lï¸yï¸ ï¸cï¸oï¸mï¸mï¸aï¸nï¸dï¸.âš™ï¸ï¸\nDiscord user '+str(ctx.author.name + '#' + ctx.author.discriminator)+' is a ğŸ› ï¸developerğŸ› ï¸ of this bot.', 'https://media.discordapp.net/attachments/719414661686099993/765490220858081280/output-onlinepngtools_32.png')
            return await embed.send(ctx)
def setup(client):
    client.add_cog(Command(client))
